<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Endless Runner â€” Game PC - Buatan YahyaIXA ğŸ˜ </title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <style>
  :root{
    --bg-1:#061022; --bg-2:#0f1724; --accent:#3b82f6;
    --muted:rgba(230,238,248,0.75);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:"Poppins",system-ui, sans-serif;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(59,130,246,0.06), transparent),
               linear-gradient(180deg,var(--bg-1),var(--bg-2));
    color:#e6eef8;overflow-x:hidden}
  body::before{content:"";position:fixed;inset:0;z-index:0;
    background-image:radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px);
    background-size:50px 50px; opacity:0.9; pointer-events:none; mix-blend-mode:overlay;
    animation:drift 40s linear infinite}
  @keyframes drift{from{transform:translateY(0)}to{transform:translateY(-120px)}}
  .wrap{position:relative;z-index:2;max-width:980px;margin:28px auto;padding:18px;text-align:center}
  header{display:flex;align-items:center;justify-content:space-between;gap:10px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.04);padding:12px 18px;border-radius:14px;
    box-shadow:0 6px 30px rgba(2,6,23,0.6);backdrop-filter:blur(6px)}
  h1{font-size:18px;margin:0;text-align:left;color:#f8fafc;font-weight:600}
  h1 small{font-weight:400;display:block;color:var(--muted);margin-top:4px;font-size:12px}
  .controls{display:flex;gap:10px;align-items:center}
  .scoreboard{display:flex;gap:12px;align-items:center;font-size:14px;color:var(--muted);
    padding:6px 10px;background:rgba(255,255,255,0.03);border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
  .scoreboard strong{color:#fff;font-weight:700;margin-left:6px}
  button{background:linear-gradient(180deg,#0c1622,#07121a);color:#e6eef8;border:none;padding:8px 14px;border-radius:10px;cursor:pointer;font-size:14px;font-weight:600;transition:all .18s;display:inline-flex;gap:8px;align-items:center;box-shadow:0 6px 18px rgba(3,64,120,0.08)}
  button.primary{background:linear-gradient(90deg,var(--accent),#2563eb);color:#fff;box-shadow:0 8px 26px rgba(37,99,235,0.18)}
  button:hover{transform:translateY(-3px)}
  .game-wrap{position:relative;margin-top:20px}
  canvas#game{display:block;margin:0 auto;background:linear-gradient(180deg,#05233a,#031a2c);border-radius:16px;box-shadow:0 12px 40px rgba(2,6,23,0.7);max-width:100%;width:900px;height:300px}
  .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
  .panel{pointer-events:auto;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.05);padding:22px;border-radius:12px;text-align:center;box-shadow:0 12px 30px rgba(0,0,0,0.6)}
  .panel h2{margin:0 0 8px;font-size:20px;color:#fff}
  .panel p{margin:0 0 12px;color:var(--muted);font-size:14px}
  .small{opacity:0.85;font-size:14px;margin-top:12px;color:var(--muted)}
  footer{margin-top:18px;font-size:14px;color:rgba(230,238,248,0.75);text-align:center}
  @media(max-width:700px){header{flex-direction:column;align-items:center;gap:8px;text-align:center}h1{font-size:16px;text-align:center}canvas#game{width:100% !important;height:auto}}
  </style>
</head>
<body>
 <div class="wrap">
  <header>
    <div style="text-align:left">
      <h1>ğŸƒâ€â™‚ï¸ Endless Runner â€” Tekan Spasi untuk lompat <br><small>Dibuat oleh <strong>yahyaIXA ğŸ˜</strong></small></h1>
    </div>

    <div class="controls">
      <div class="scoreboard" title="Score dan Highscore">
        <span>Score: <strong id="score">0</strong></span>
        <span>High: <strong id="high">0</strong></span>
      </div>
      <button id="btn-start" class="primary">ğŸ” Mulai / Restart</button>
      <button id="btn-mute" title="Mute (belum aktif)">ğŸ”ˆ</button>
    </div>
  </header>

  <div class="game-wrap" style="margin-top:18px;">
    <canvas id="game" width="900" height="300"></canvas>

    <div class="overlay" id="overlay">
      <div class="panel" id="overlay-panel">
        <h2>Siap bermain?</h2>
        <p>Tekan <strong>Space</strong> atau klik "Mulai / Restart" untuk mulai. Gunakan â†‘ untuk lompat dan â†“ untuk turun.</p>
        <div style="display:flex;gap:8px;justify-content:center;">
          <button id="overlay-start" class="primary">Mulai</button>
          <button id="overlay-how" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)">Cara Main</button>
        </div>
      </div>
    </div>
  </div>

  <div class="small" style="margin-top:12px;">
    ğŸ® Kontrol: <strong>Spasi</strong> / <strong>Panah Atas</strong> = Lompat, <strong>Panah Bawah</strong> = Turun â€” Cocok untuk dimainkan di <strong>PC</strong>.
  </div>

  <footer>
    <div class="small">Dibuat dengan <strong>HTML5 Canvas + JavaScript</strong> â€” Simpel, ringan, dan seru!</div>
  </footer>
 </div>

<hr style="margin:40px auto;width:60%;border:0;border-top:1px solid rgba(255,255,255,0.08)">

<div style="text-align:center;font-size:16px;color:rgba(230,238,248,0.75);">
  <p>ğŸ§© Coba mainkan game lainnya: <strong>Puzzle Sederhana</strong><br><em>Hati-hati... nanti bisa ketagihan ğŸ˜†</em></p>
  <a href="pazel.index.html"><button style="margin-top:8px;">Main Sekarang juga!</button></a>
</div>

<script>
/* ====== Game logic (diperbaiki agar tidak crash jika elemen belum ada) ====== */
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

let running = false;
let score = 0;
let highScore = Number(localStorage.getItem('endless_high') || 0);

// safe DOM references (elemen ada di markup sekarang)
const scoreEl = document.getElementById('score');
const highEl = document.getElementById('high');
const btnStart = document.getElementById('btn-start');
const overlay = document.getElementById('overlay');
const overlayStart = document.getElementById('overlay-start');

if (scoreEl) scoreEl.textContent = score;
if (highEl) highEl.textContent = highScore;

// player & world
const player = { x:80, y: H - 70, w:40, h:48, vy:0, gravity:0.9, jumpPower:15, grounded:true, crouch:false };
const groundY = H - 20;
let obstacles = [];
let spawnTimer = 0;
let speed = 6;

// input
const keys = {};
window.addEventListener('keydown', e => {
  keys[e.code] = true;
  if (!running && (e.code === 'Space' || e.code === 'ArrowUp')) startGame();
  if (['Space','ArrowUp','ArrowDown'].includes(e.code)) e.preventDefault();
});
window.addEventListener('keyup', e => { keys[e.code] = false; });

// btn events
btnStart.addEventListener('click', startGame);
overlayStart.addEventListener('click', startGame);
document.getElementById('overlay-how').addEventListener('click', ()=> {
  alert('Cara main: Tekan Spasi atau Panah Atas untuk lompat. Panah Bawah untuk turun saat di tanah.');
});

// game functions
function resetGame(){
  score = 0; if (scoreEl) scoreEl.textContent = score;
  obstacles = [];
  spawnTimer = 60 + Math.floor(Math.random()*90);
  speed = 6;
  player.y = H - 70; player.vy = 0; player.grounded = true; player.crouch = false;
}

function startGame(){
  resetGame();
  running = true;
  hideOverlay();
  // ensure loop is running (loop always runs via RAF)
}

function showOverlay(message){
  const panel = document.getElementById('overlay-panel');
  if (panel && message){
    panel.querySelector('h2').textContent = 'Game Over';
    panel.querySelector('p').textContent = message;
    overlay.style.pointerEvents = 'auto';
    overlay.style.opacity = '1';
  }
  overlay.style.display = 'flex';
}

function hideOverlay(){
  overlay.style.pointerEvents = 'none';
  overlay.style.display = 'none';
  // restore overlay text to default for next time
  const panel = document.getElementById('overlay-panel');
  if (panel){
    panel.querySelector('h2').textContent = 'Siap bermain?';
    panel.querySelector('p').textContent = 'Tekan Space atau klik "Mulai / Restart" untuk mulai. Gunakan â†‘ untuk lompat dan â†“ untuk turun.';
  }
}

function gameOver(){
  running = false;
  if (score > highScore){
    highScore = score;
    localStorage.setItem('endless_high', highScore);
    if (highEl) highEl.textContent = highScore;
  }
  showOverlay('Klik "Mulai / Restart" atau tekan Space untuk mulai lagi. Score: ' + score + ' â€¢ High: ' + highScore);
}

function spawnObstacle(){
  const h = 20 + Math.floor(Math.random()*46);
  const w = 18 + Math.floor(Math.random()*40);
  obstacles.push({x: W + 20, y: groundY - h, w, h, passed:false});
}

function update(dt){
  // input jump
  if ((keys['Space'] || keys['ArrowUp']) && player.grounded){
    player.vy = -player.jumpPower; player.grounded = false; player.crouch = false;
  }
  player.crouch = !!keys['ArrowDown'] && player.grounded;

  // physics
  player.vy += player.gravity; player.y += player.vy;
  if (player.y + player.h >= groundY){ player.y = groundY - player.h; player.vy = 0; player.grounded = true; }

  // speed scaling
  if (running && score % 100 === 0 && score !== 0) speed = 6 + Math.floor(score / 200);

  // obstacles
  for (let i = obstacles.length-1; i>=0; i--){
    const o = obstacles[i];
    o.x -= speed;
    if (!o.passed && o.x + o.w < player.x){ score++; o.passed = true; if (scoreEl) scoreEl.textContent = score; }
    if (o.x + o.w < -50) obstacles.splice(i,1);
    if (rectIntersect(player.x, player.y, player.w, player.h, o.x, o.y, o.w, o.h)){
      gameOver();
    }
  }

  // spawn
  spawnTimer -= 1;
  if (spawnTimer <= 0){ spawnObstacle(); spawnTimer = 60 + Math.floor(Math.random()*90); }
}

function rectIntersect(x1,y1,w1,h1,x2,y2,w2,h2){
  return !(x2 > x1 + w1 || x2 + w2 < x1 || y2 > y1 + h1 || y2 + h2 < y1);
}

function draw(){
  ctx.clearRect(0,0,W,H);
  // sky
  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0,'#0a3150'); g.addColorStop(1,'#033046');
  ctx.fillStyle = g; ctx.fillRect(0,0,W,H);

  // ground
  ctx.fillStyle = '#052029'; ctx.fillRect(0,groundY, W, H-groundY);
  for (let x=0;x<W;x+=40){ ctx.fillStyle = 'rgba(255,255,255,0.02)'; ctx.fillRect(x, groundY+6, 20, 2); }

  // player
  ctx.save();
  ctx.fillStyle = '#ff8a42';
  if (player.crouch){ ctx.fillRect(player.x, player.y + 12, player.w, player.h - 12); }
  else{ ctx.fillRect(player.x, player.y, player.w, player.h); }
  ctx.restore();

  // obstacles
  ctx.fillStyle = '#ff6b6b';
  obstacles.forEach(o => { ctx.fillRect(o.x, o.y, o.w, o.h); });

  // scoreboard on canvas (redundant with DOM, but kept)
  ctx.fillStyle = 'rgba(230,238,248,0.9)'; ctx.font = '16px Arial'; ctx.textAlign='left';
  ctx.fillText('Score: '+score, 12, 22);
  ctx.fillText('High: '+highScore, 12, 40);

  // hint when not running
  if (!running){
    ctx.fillStyle='rgba(230,238,248,0.9)'; ctx.textAlign='center'; ctx.font='15px Arial';
    ctx.fillText('Klik "Mulai / Restart" atau tekan Space untuk mulai', W/2, H/2 - 70);
  }
}

// main loop (always scheduled, update only when running)
let last = performance.now();
function loop(now){
  const t = now || performance.now();
  const dt = t - last; last = t;
  if (running){ update(dt); }
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// initial state: show overlay
showOverlay('Tekan Mulai untuk memulai permainan.');

// responsive canvas resizing
window.addEventListener('resize', () => {
  const maxW = Math.min(1100, window.innerWidth - 40);
  const scale = Math.min(1, maxW / 900);
  canvas.style.width = Math.floor(900 * scale) + 'px';
});
window.dispatchEvent(new Event('resize'));
</script>
</body>
</html>
